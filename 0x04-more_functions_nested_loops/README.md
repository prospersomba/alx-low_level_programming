Doing some work on more funcions and nested loops
